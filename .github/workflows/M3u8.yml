# Ä°ÅŸ akÄ±ÅŸÄ±nÄ±n adÄ± (GitHub Actions sekmesinde bu isimle gÃ¶rÃ¼necek)
name: CanlÄ± YayÄ±n Linklerini GÃ¼ncelle

on:
  # ZamanlanmÄ±ÅŸ gÃ¶rev: Bu ayar, botu her 2 saatte bir otomatik olarak Ã§alÄ±ÅŸtÄ±rÄ±r.
  schedule:
    - cron: '0 */2 * * *'
  
  # Manuel Ã§alÄ±ÅŸtÄ±rma: GitHub Actions panelinden "Run workflow" butonuyla elle baÅŸlatmanÄ± saÄŸlar.
  workflow_dispatch:

jobs:
  # "guncelle" adÄ±nda bir gÃ¶rev tanÄ±mlÄ±yoruz.
  guncelle:
    # GÃ¶revin Ã§alÄ±ÅŸacaÄŸÄ± sanal makine: en gÃ¼ncel Ubuntu versiyonu.
    runs-on: ubuntu-latest

    # GÃ¶revin adÄ±mlarÄ±:
    steps:
      # 1. AdÄ±m: Repository'deki kodlarÄ± sanal makineye kopyalar.
      - name: Proje dosyalarÄ±nÄ± kopyala
        uses: actions/checkout@v4

      # 2. AdÄ±m: Belirtilen Python versiyonunu (3.10) kurar.
      - name: Python 3.10 versiyonunu kur
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      # 3. AdÄ±m: Selenium gibi kÃ¼tÃ¼phanelerin Ã§alÄ±ÅŸmasÄ± iÃ§in gerekli olan Chrome tarayÄ±cÄ± ve sÃ¼rÃ¼cÃ¼sÃ¼nÃ¼ kurar.
      - name: Chrome ve ChromeDriver'Ä± kur
        uses: browser-actions/setup-chrome@v1
      
      # YENÄ° VE Ã–NEMLÄ° ADIM: Gerekli Python kÃ¼tÃ¼phanelerini yÃ¼kler.
      - name: Gerekli Python kÃ¼tÃ¼phanelerini yÃ¼kle
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      # DÃœZELTÄ°LDÄ°: ArtÄ±k doÄŸru script adÄ±nÄ± Ã§alÄ±ÅŸtÄ±rÄ±yor.
      - name: Linkleri Ã§Ä±karan Python script'ini Ã§alÄ±ÅŸtÄ±r
        run: python extract_m3u8.py

      # 6. AdÄ±m: OluÅŸturulan veya gÃ¼ncellenen dosyalarÄ± otomatik olarak repository'e kaydeder (commit'ler).
      - name: DeÄŸiÅŸiklikleri kaydet
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          # KayÄ±t (commit) mesajÄ±
          commit_message: "ğŸ” CanlÄ± yayÄ±n linkleri otomatik olarak gÃ¼ncellendi"
          # DeÄŸiÅŸikliklerin hangi dala (branch) kaydedileceÄŸi
          branch: main